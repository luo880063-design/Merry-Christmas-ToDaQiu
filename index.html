<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Merry Christmas To 大球</title>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Zhi+Mang+Xing&display=swap" rel="stylesheet">
    
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #050505;
            touch-action: none;
        }
        canvas {
            display: block;
        }

        /* --- 文字容器 --- */
        #text-container {
            position: absolute;
            z-index: 10;
            pointer-events: none;
            
            /* 右对齐 */
            text-align: right; 
            
            /* 电脑端位置 */
            top: 50%;
            left: 10%; 
            transform: translateY(-50%);
        }

        /* 通用发光动画 */
        @keyframes textGlow {
            0% { opacity: 0.85; transform: scale(1); }
            100% { opacity: 1; transform: scale(1.02); }
        }

        /* 第一行：Merry Christmas */
        h1 {
            font-family: 'Great Vibes', cursive;
            color: #fff;
            font-size: 5.5rem; 
            font-weight: normal;
            margin: 0;
            line-height: 1.1;
            /* 华丽的光晕 */
            text-shadow: 0 0 10px rgba(255, 192, 203, 0.8), 
                         0 0 20px rgba(255, 105, 180, 0.6),
                         0 0 40px rgba(255, 215, 0, 0.4); 
            animation: textGlow 3s ease-in-out infinite alternate;
        }
        
        /* 第二行：—To 大球 */
        .sub-text {
            /* 关键修改：混合字体栈。
               浏览器会先用 Great Vibes 渲染英文，
               遇到中文时自动使用 Zhi Mang Xing 渲染 */
            font-family: 'Great Vibes', 'Zhi Mang Xing', cursive; 
            
            color: #ffb7c5; 
            font-size: 2.8rem; /* 因为中文花体字通常视觉上偏小，这里稍微再调大一点 */
            margin-top: 5px;
            font-weight: normal;
            
            /* 同样加上柔和的光晕 */
            text-shadow: 0 0 10px rgba(255, 192, 203, 0.8), 
                         0 0 20px rgba(255, 105, 180, 0.4);
            animation: textGlow 3s ease-in-out infinite alternate-reverse;
        }

        /* --- 手机端适配 --- */
        @media (max-width: 768px) {
            #text-container {
                /* 手机上文字位置 */
                top: 15%;
                left: auto;
                right: 5%; 
                transform: none;
                width: 90%;
            }
            h1 { font-size: 3.5rem; }
            .sub-text { font-size: 2.0rem; } 
        }
    </style>
</head>
<body>

    <div id="text-container">
        <h1>Merry Christmas</h1>
        <div class="sub-text">—To 大球</div>
    </div>
    <canvas id="canvas"></canvas>

<script>
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    let w, h;
    let particles = [];
    let snowParticles = [];
    let treeCenterX, treeCenterY;

    // --- 配置参数 ---
    const config = {
        treeColor: 'hsla(335, 100%, 70%, 0.8)', // 粉色树叶
        trunkColor: 'hsla(335, 80%, 40%, 1)',   // 深粉树干
        sparkleColor: 'hsla(320, 100%, 95%, 1)', // 亮白高光
        lightColor: 'hsla(50, 100%, 60%, 1)',    // 暖黄彩灯
        
        snowColor: 'rgba(255, 255, 255, 0.9)',
        leafCount: 1800,  // 高密度树叶
        trunkCount: 150,
        snowCount: 200
    };

    function resize() {
        w = canvas.width = window.innerWidth;
        h = canvas.height = window.innerHeight;

        if (w > h) {
            // 电脑：树在右侧
            treeCenterX = w * 0.75;
            treeCenterY = h * 0.5 + 40; 
        } else {
            // 手机：树在中间偏下
            treeCenterX = w * 0.5;
            treeCenterY = h * 0.65; 
        }
    }
    window.addEventListener('resize', resize);
    resize();

    const fov = 350;
    const viewDist = 550; 
    let angleY = 0;

    // --- 粒子系统 ---
    class Particle {
        constructor(type) {
            this.type = type;
            this.reset();
        }

        reset() {
            if (this.type === 'trunk') {
                const trunkHeight = 100;
                const trunkWidth = 35; 
                this.y = 350 + Math.random() * trunkHeight; 
                
                const angle = Math.random() * Math.PI * 2;
                const r = Math.random() * trunkWidth;
                
                this.x = Math.cos(angle) * r;
                this.z = Math.sin(angle) * r;
                
                this.color = config.trunkColor;
                this.size = Math.random() * 2 + 2;
                this.blinkSpeed = 0;
                this.alpha = 1;
                
            } else if (this.type === 'leaf') {
                const treeHeight = 750;
                this.y = (Math.random() * treeHeight) - 400; 
                
                const normY = (this.y + 400) / treeHeight;
                const maxRadius = 320 * normY; 
                const r = Math.random() * maxRadius;
                const angle = Math.random() * Math.PI * 2;

                this.x = Math.cos(angle) * r;
                this.z = Math.sin(angle) * r;

                const randomVal = Math.random();
                if (randomVal > 0.94) {
                    this.color = config.lightColor; // 黄灯
                    this.size = Math.random() * 3 + 3.5;
                    this.blinkSpeed = 0.02 + Math.random() * 0.03;
                    this.isLight = true;
                } else if (randomVal > 0.88) {
                    this.color = config.sparkleColor; // 高光
                    this.size = Math.random() * 2 + 1;
                    this.blinkSpeed = 0.04 + Math.random() * 0.08;
                    this.isLight = false;
                } else {
                    this.color = config.treeColor; // 叶子
                    this.size = Math.random() * 2 + 1.5;
                    this.blinkSpeed = 0.01;
                    this.isLight = false;
                }
                this.alpha = 0.4 + Math.random() * 0.6;
            }
        }

        update() {
            if (this.blinkSpeed > 0 && this.type === 'leaf') {
                this.alpha += this.blinkSpeed;
                if (this.isLight) {
                    if (this.alpha > 1 || this.alpha < 0.6) this.blinkSpeed *= -1;
                } else {
                    if (this.alpha > 1 || this.alpha < 0.3) this.blinkSpeed *= -1;
                }
            }
        }

        draw() {
            const cos = Math.cos(angleY);
            const sin = Math.sin(angleY);
            const rx = this.x * cos - this.z * sin;
            const rz = this.z * cos + this.x * sin;

            const scale = fov / (fov + rz + viewDist);
            const x2d = rx * scale + treeCenterX;
            const y2d = this.y * scale + treeCenterY;

            if (scale > 0) {
                ctx.fillStyle = this.color;
                ctx.globalAlpha = this.alpha;
                ctx.beginPath();
                ctx.arc(x2d, y2d, this.size * scale, 0, Math.PI * 2);
                ctx.fill();
                
                if (this.isLight && this.type === 'leaf') {
                    ctx.shadowBlur = 15 * scale;
                    ctx.shadowColor = this.color;
                    ctx.fill();
                    ctx.shadowBlur = 0;
                }
                ctx.globalAlpha = 1;
            }
        }
    }

    class Snow {
        constructor() {
            this.reset(true);
        }
        reset(initial = false) {
            this.x = Math.random() * w;
            this.y = initial ? Math.random() * h : -10;
            this.z = (Math.random() - 0.5) * 800;
            this.vy = 0.8 + Math.random() * 1.5; 
            this.size = Math.random() * 3 + 0.5;
        }
        update() {
            this.y += this.vy;
            if (this.y > h) this.reset();
        }
        draw() {
            ctx.fillStyle = config.snowColor;
            const scale = 1 + (this.z / 1000); 
            ctx.globalAlpha = 0.7;
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size * scale, 0, Math.PI * 2);
            ctx.fill();
            ctx.globalAlpha = 1;
        }
    }

    function init() {
        particles = [];
        snowParticles = [];

        for (let i = 0; i < config.leafCount; i++) particles.push(new Particle('leaf'));
        for (let i = 0; i < config.trunkCount; i++) particles.push(new Particle('trunk'));
        
        // 树顶星星
        for (let i=0; i<40; i++) {
            let p = new Particle('leaf'); 
            p.y = -410; 
            p.x = (Math.random()-0.5)*12;
            p.z = (Math.random()-0.5)*12;
            p.color = '#fff';
            p.size = 3; 
            p.isLight = true;
            particles.push(p);
        }

        for (let i = 0; i < config.snowCount; i++) snowParticles.push(new Snow());
    }

    function animate() {
        ctx.clearRect(0, 0, w, h);
        
        ctx.globalCompositeOperation = 'lighter'; 

        particles.sort((a, b) => {
            const az = a.z * Math.cos(angleY) + a.x * Math.sin(angleY);
            const bz = b.z * Math.cos(angleY) + b.x * Math.sin(angleY);
            return bz - az;
        });

        particles.forEach(p => {
            p.update();
            p.draw();
        });

        ctx.globalCompositeOperation = 'source-over'; 
        snowParticles.forEach(p => {
            p.update();
            p.draw();
        });

        angleY -= 0.003; 
        requestAnimationFrame(animate);
    }

    init();
    animate();

</script>
</body>
</html>
